---
title: 题解|1007.Expectation (Easy Version)-2023暑期杭电多校05
date: 2023/8/1
updated: 2023/9/28
tags:
  - 2023暑期杭电多校
  -  
categories: 算法竞赛
keywords:
top_img: false
comments: true
cover:
toc: true
abbrlink: 4f32a99a
description: 题解|1007.Expectation (Easy Version)-2023暑期杭电多校05 概率/期望
toc_number:
toc_style_simple:
copyright:
copyright_author:
copyright_author_href:
copyright_url:
copyright_info:
highlight_shrink:
aside:
---

# 1007.Expectation (Easy Version)
**数学期望**
## 题目大意
玩 $n$ 次游戏，每次游戏胜利的概率为 $\dfrac{a}{b}$ 
对于给定的 $m$ ，每次游戏胜利将获得 $k^m$ 分，其中 $k$ 是当前总胜利局数，失败得 $0$ 分
最终得分为 $n$ 次游戏的得分之和，求最终得分的期望

## 解题思路
从全局角度考虑得分情况，游戏输赢概率满足二项分布，记获胜概率为 $p=\dfrac{a}{b}$
在 $n$ 局游戏中赢 $k$ 局的概率为： $C_n^k\cdot p^k(1-p)^{n-k}$
赢 $k$ 局游戏可以获得的最终得分记为 $score(k)$ ： $score(k)=\sum\limits_{i=1}^k i^m$
故最终得分期望为： $E=\sum\limits_{i=1}^n C_n^k\cdot p^k(1-p)^{n-k}\cdot score(k)$

分别预处理阶乘、乘方、得分数组，求和取模即可

### 时间复杂度
乘方、阶乘、求和取模： $O(n)$
得分（快速幂+前缀和）： $O(n\log m)$
总时间复杂度： $O(n\log m)$

## 参考代码
> 参考代码为已AC代码主干，其中功能请读者自行实现

```cpp
vector<ll> powp,pownp,score;//p的n次、q的n次、赢n局的得分
void solve()
{
    ll n,m,a,b,re=0;
    cin >> n >> m >> a >> b;
    ll p=mul(a,inv(b));//获胜的概率
    ll np=Get_Mod(1-p);//失败的概率
    powp.clear();pownp.clear();score.clear();
    powp.resize(n+1);pownp.resize(n+1);score.resize(n+1);
    powp[0]=pownp[0]=1;score[0]=0;
    FORLL(i,1,n){
        powp[i]=mul(powp[i-1],p);
        pownp[i]=mul(pownp[i-1],np);
        score[i]=add(score[i-1],qcpow(i,m));}
    FORLL(i,1,n)
        re=add(re,mul(score[i],mul(Get_Combination(n,i),mul(powp[i],pownp[n-i]))));
        //Ex(i)=C(n,i)*p^i*(1-p)^(n-i)*score(i)
    cout << re << endl;
}
```