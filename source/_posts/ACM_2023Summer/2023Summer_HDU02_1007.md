---
title: 题解|1007.foreverlasting and fried-chicken-2023暑期杭电多校02
date: 2023/7/20
updated: 2023/9/27
tags:
  - 2023暑期杭电多校
  - 计数
categories: 算法竞赛
keywords:
top_img: false
comments: true
cover:
toc: true
abbrlink: 9a2da1fd
description: 题解|1007.foreverlasting and fried-chicken-2023暑期杭电多校02 子图计数
toc_number:
toc_style_simple:
copyright:
copyright_author:
copyright_author_href:
copyright_url:
copyright_info:
highlight_shrink:
aside:
---

# 1007.foreverlasting and fried-chicken
**图论、枚举**
## 题目大意
给定一个无权无向图 $G=(V,E),|V|=n,|E|=m$ 
求图中包含以下子图的数量：
![Img](/images/ACM/2023Summer_HDU02_1007.png)

## 解题思路
对于这个子图，有一个度为4的点和一个度为6的点，他们有4个公共邻居。借助这个特征，在给定无向图中找点

构图，在过程中记录每个点的度数 $deg_i$

对于每个 $deg_1\ge6$ 的点 $v_1$ ，枚举 $deg_2\ge4$ 的点 $v_2$
计算公共邻居个数，记为 $nbr$ 
对于 $v_1,v_2$ ，其含有上述子图个数为：$C_{nbr}^4 \cdot C_{deg_1-4}^2$
（注意：如果  $v_1,v_2$ 相连，这条边是不允许被构入子图的，计算的度是要减去1）

计算每一对 $v_1,v_2$ 的个数之和即可

### 时间复杂度
朴素的做法的时间复杂度是 $O(n^3)$ （会有人T到飞起）
考虑用bitset对图进行状态压缩，降低求 $nbr$ 的时间复杂度
最终时间复杂度为  $O(\dfrac{n^3}{\omega})$ 

## 参考程序
> 参考代码为已AC代码主干，其中部分功能需读者自行实现

```cpp
ll C[1005][1005]={0};
//在主函数中预处理组合数C，代码略
int solve()
{
    ll n,m;
    cin >> n >> m;
    bitset<1005> G[1005];
    int deg[1005]={0};
    ll u,v;
    FORLL(i,1,m){
        cin >> u >> v;
        G[u].set(v);
        G[v].set(u);
        deg[u]++;deg[v]++;
    }
    ll re=0,nbr,deg1,deg2;
    FORLL(i,1,n) if(deg[i]>=4){
        FORLL(j,i+1,n) if(j-i&&deg[j]>=4){
            deg1=deg[i]-G[i][j];
            deg2=deg[j]-G[i][j];
            //如果vi,vj直接相连，这条边是不能构入的
            nbr=(G[i]&G[j]).count();
            if(nbr>=4){
                if(deg1>=6) re=add(re,mul(C[nbr][4],C[deg1-4][2]));
                if(deg2>=6) re=add(re,mul(C[nbr][4],C[deg2-4][2]));
            }
        }
    }

    cout << re << endl;
    return 0;
}
```