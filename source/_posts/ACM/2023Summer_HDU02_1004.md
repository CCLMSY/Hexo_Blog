---
title: 题解|1004.Card Game-2023暑期杭电多校02
date: 2023/7/20
updated: 2023/9/27
tags:
  - 2023暑期杭电多校
  - 思维
  - 模拟
categories: 算法竞赛
keywords:
top_img: false
comments: true
cover:
toc: true
abbrlink: 861a0ba3
description: 题解|1004.Card Game-2023暑期杭电多校02 模拟·思维·递归
toc_number:
toc_style_simple:
copyright:
copyright_author:
copyright_author_href:
copyright_url:
copyright_info:
highlight_shrink:
aside:
---

# 1004.Card Game
**思维题**
## 题目大意
游戏规则和汉诺塔类似
有 $n$ 根柱子，起始在第1根柱子上从下到上摆放着编号 $k,k-1,\cdots,2,1$ 的卡牌
规定：每根柱子只能从下到上放编号**连续且递减**的卡牌
每次操作可以将一根柱子上的最顶端的卡牌移动到其他柱子上（且不能违反规定）
求对于给定的柱子根数 $n$ ，可以实现将第一根柱子上所有牌移动到第二根柱子上的最大卡牌张数 $k$
## 解题思路
这道题可以采用逆向思维。
起始态和最终态同构，拆解和合并过程对称，考虑从中间关键步骤分解顺推：
1. 将最大点数的卡牌从 柱子$1$ 转移到 柱子$2$ 
2. 此时有 $1$ 个空位，可以将牌数为 $2$ 的柱子（假设他们恰好是次大的）拆分合并到柱子 $2$ ，并产生一个新的空位……
3. 每次完全合并一个柱子，就会多一个空位，空位多的状态包含了空位少的状态。考虑状态转移关系：
   1. 记：利用 $x$ 个空位可以转移到目标柱子的最大牌数为 $f(x)$ 
   显然： $f(0)=1$ 
   2. 假设目前有个 $x$ 空位，对于本轮要转移的柱子，可以先借用一个空位存储上半部分较小卡牌。存储数量为  $f(x-1)$ ，因为存储本身需要占用一个空位
   3. 利用剩余 $x-1$ 个空位，最多可以转移并合并 $f(x-1)$ 张卡牌到柱子 $2$ 
   4. 再利用剩余 $x-1$ 个空位，将存储的 $f(x-1)$ 张卡牌到柱子 $2$
   5. 综3.1-3.4，可以得到 $f(x)$ 的递推式： $f(x)=2f(x-1)$
   并求得 $f(x)=2^n$ 
4. 第一步可以看作：利用 $0$ 个空位，将最大点数的卡牌从 柱子$1$ 转移到 柱子$2$ 
   最后一步可以看作：利用 $n-2$ 个空位，将最后一堆卡牌从转移到 柱子$2$ 
   中途每一步产生 $1$ 个空位
   由此得到结果：

$$\begin{align}
    k
    &=\sum\limits_{i=0}^{n-2} f(i) \newline
    &=1+2+\cdots+2^{n-2} \newline
    &=2^{n-1}-1
\end{align}
$$

快速幂斩了

## 参考程序
> 参考代码为已AC代码主干，其中部分功能需读者自行实现

```cpp
int solve()
{
    ll n;
    cin >> n;
    cout << Get_Mod(qcpow(2,n-1)-1) << endl;
    //快速幂代码略
    return 0;
}

```